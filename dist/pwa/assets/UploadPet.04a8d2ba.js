import{u as G,a as H,b as X,c as Z,d as ee,e as te,f as le,g as ae,h as ne,i as z,j as ie,k as oe,Q as $}from"./QInput.adb100d5.js";import{f as Q,aq as ue,ar as se,c as d,J as re,aC as ce,g as N,h as g,W as A,as as de,u as D,r as B,C as fe,K as me,ae as ve,ad as be,o as ge,j as he,n as ye,ap as pe,a as xe,aD as Ce,R as Se,S as Ve,U as qe,V as R,d as k,ao as O,a5 as Fe,a1 as T,Y as ke}from"./index.0c40a758.js";import{u as _e,a as Be,b as Ie}from"./user.bc24edf9.js";import{h as Pe}from"./format.8f2d0f18.js";import{Q as Re}from"./QPage.84017e2b.js";import{r as Ae,a as je,u as we,T as De,V as Qe,d as Ne}from"./firebase.7a5a15bc.js";const Ee={xs:8,sm:10,md:14,lg:20,xl:24};var ze=Q({name:"QChip",props:{..._e,...ue,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:y,emit:f}){const{proxy:{$q:h}}=N(),m=Be(e,h),u=se(e,Ee),r=d(()=>e.selected===!0||e.icon!==void 0),C=d(()=>e.selected===!0?e.iconSelected||h.iconSet.chip.selected:e.icon),S=d(()=>e.iconRemove||h.iconSet.chip.remove),s=d(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),o=d(()=>{const n=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(n?` text-${n} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(s.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(m.value===!0?" q-chip--dark q-dark":"")}),l=d(()=>e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0});function q(n){n.keyCode===13&&a(n)}function a(n){e.disable||(f("update:selected",!e.selected),f("click",n))}function c(n){(n.keyCode===void 0||n.keyCode===13)&&(D(n),e.disable===!1&&(f("update:modelValue",!1),f("remove")))}function i(){const n=[];s.value===!0&&n.push(g("div",{class:"q-focus-helper"})),r.value===!0&&n.push(g(A,{class:"q-chip__icon q-chip__icon--left",name:C.value}));const F=e.label!==void 0?[g("div",{class:"ellipsis"},[e.label])]:void 0;return n.push(g("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},de(y.default,F))),e.iconRight&&n.push(g(A,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&n.push(g(A,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:S.value,...l.value,onClick:c,onKeyup:c})),n}return()=>{if(e.modelValue===!1)return;const n={class:o.value,style:u.value};return s.value===!0&&Object.assign(n,l.value,{onClick:a,onKeyup:q}),re("div",n,i(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[ce,e.ripple]])}}}),$e=Q({name:"QFile",inheritAttrs:!1,props:{...G,...H,...X,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Z,...ee],setup(e,{slots:y,emit:f,attrs:h}){const{proxy:m}=N(),u=te(),r=B(null),C=B(!1),S=le(e),{pickFiles:s,onDragover:o,onDragleave:l,processFiles:q,getDndNode:a}=ae({editable:u.editable,dnd:C,getFileInput:M,addFilesToQueue:E}),c=ne(e),i=d(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),n=d(()=>z(i.value)),F=d(()=>i.value.map(t=>t.name).join(", ")),p=d(()=>Pe(i.value.reduce((t,b)=>t+b.size,0))),v=d(()=>({totalSize:p.value,filesNumber:i.value.length,maxFiles:e.maxFiles})),_=d(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:S.value,...h,id:u.targetUid.value,disabled:u.editable.value!==!0})),V=d(()=>"q-file q-field--auto-height"+(C.value===!0?" q-file--dnd":"")),I=d(()=>e.multiple===!0&&e.append===!0);function P(t){const b=i.value.slice();b.splice(t,1),w(b)}function K(t){const b=i.value.findIndex(t);b>-1&&P(b)}function w(t){f("update:modelValue",e.multiple===!0?t:t[0])}function U(t){t.keyCode===13&&fe(t)}function L(t){(t.keyCode===13||t.keyCode===32)&&s(t)}function M(){return r.value}function E(t,b){const x=q(t,b,i.value,I.value);x!==void 0&&((e.multiple===!0?e.modelValue&&x.every(Y=>i.value.includes(Y)):e.modelValue===x[0])||w(I.value===!0?i.value.concat(x):x))}function j(){return[g("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function J(){if(y.file!==void 0)return i.value.length===0?j():i.value.map((b,x)=>y.file({index:x,file:b,ref:this}));if(y.selected!==void 0)return i.value.length===0?j():y.selected({files:i.value,ref:this});if(e.useChips===!0)return i.value.length===0?j():i.value.map((b,x)=>g(ze,{key:"file-"+x,removable:u.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{P(x)}},()=>g("span",{class:"ellipsis",textContent:b.name})));const t=e.displayValue!==void 0?e.displayValue:F.value;return t.length>0?[g("div",{class:e.inputClass,style:e.inputStyle,textContent:t})]:j()}function W(){const t={ref:r,..._.value,...c.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:E};return e.multiple===!0&&(t.multiple=!0),g("input",t)}return Object.assign(u,{fieldClass:V,emitValue:w,hasValue:n,inputRef:r,innerValue:i,floatingLabel:d(()=>n.value===!0||z(e.displayValue)),computedCounter:d(()=>{if(e.counterLabel!==void 0)return e.counterLabel(v.value);const t=e.maxFiles;return`${i.value.length}${t!==void 0?" / "+t:""} (${p.value})`}),getControlChild:()=>a("file"),getControl:()=>{const t={ref:u.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return u.editable.value===!0&&Object.assign(t,{onDragover:o,onDragleave:l,onKeydown:U,onKeyup:L}),g("div",t,[W()].concat(J()))}}),Object.assign(m,{removeAtIndex:P,removeFile:K,getNativeElement:()=>r.value}),ie(u)}}),Oe=Q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(e,{slots:y,emit:f}){const h=N(),m=B(null);let u=0;const r=[];function C(a){const c=[],i=typeof a=="boolean"?a:e.noErrorFocus!==!0,n=++u,F=(p,v)=>{f("validation-"+(p===!0?"success":"error"),v)};for(let p=0;p<r.length;p++){const v=r[p],_=v.validate();if(typeof _.then=="function")c.push(_.then(V=>({valid:V,comp:v}),V=>({valid:!1,comp:v,err:V})));else if(_!==!0){if(e.greedy===!1)return F(!1,v),i===!0&&typeof v.focus=="function"&&v.focus(),Promise.resolve(!1);c.push({valid:!1,comp:v})}}return c.length===0?(F(!0),Promise.resolve(!0)):Promise.all(c).then(p=>{const v=p.filter(P=>P.valid!==!0);if(v.length===0)return n===u&&F(!0),!0;const{valid:_,comp:V,err:I}=v[0];return n===u&&(I!==void 0&&console.error(I),F(!1,V),i===!0&&_!==!0&&typeof V.focus=="function"&&V.focus()),!1})}function S(){u++,r.forEach(a=>{typeof a.resetValidation=="function"&&a.resetValidation()})}function s(a){a!==void 0&&D(a);const c=u+1;C().then(i=>{c===u&&i===!0&&(e.onSubmit!==void 0?f("submit",a):a!==void 0&&a.target!==void 0&&typeof a.target.submit=="function"&&a.target.submit())})}function o(a){a!==void 0&&D(a),f("reset"),ye(()=>{S(),e.autofocus===!0&&e.noResetFocus!==!0&&l()})}function l(){oe(()=>{if(m.value===null)return;const a=m.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(m.value.querySelectorAll("[tabindex]"),c=>c.tabIndex>-1);a!=null&&a.focus({preventScroll:!0})})}me(pe,{bindComponent(a){r.push(a)},unbindComponent(a){const c=r.indexOf(a);c>-1&&r.splice(c,1)}});let q=!1;return ve(()=>{q=!0}),be(()=>{q===!0&&e.autofocus===!0&&l()}),ge(()=>{e.autofocus===!0&&l()}),Object.assign(h.proxy,{validate:C,resetValidation:S,submit:s,reset:o,focus:l,getValidationComponents:()=>r}),()=>g("form",{class:"q-form",ref:m,onSubmit:s,onReset:o},he(y.default))}});function Te(){return xe(Ce)}const Ke=ke("Imagenes de la mascota"),Ge=Se({__name:"UploadPet",setup(e){const y=Te(),f=B(null),h=B(null),m=B([]);function u(s){const o=[];return m.value&&m.value.forEach(l=>{console.log(l);const q=Ae(je,`pets/${s}/${l.name}`);o.push(we(q,l))}),o}async function r(){const{user:s}=Ie();return(await De(Qe(Ne,"pets"),{title:f.value,desc:h.value,user:{uid:s.uid,email:s.email,displayName:s.displayName},createdAt:Date.now()})).id}async function C(){y.notify({color:"blue-4",textColor:"white",icon:"cloud_done",message:"Enviando anuncio..."});const s=await r();await Promise.all(u(s)),S(),y.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Enviado"})}function S(){f.value=null,h.value=null,m.value.length=0}return(s,o)=>(Ve(),qe(Re,{padding:""},{default:R(()=>[k(Oe,{onSubmit:C,onReset:S,class:"q-gutter-md"},{default:R(()=>[k($,{filled:"",modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=l=>f.value=l),label:"Titulo",hint:"Titulo del anuncio","lazy-rules":"",rules:[l=>l&&l.length>0||"Escribe algo"]},null,8,["modelValue","rules"]),k($,{filled:"",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=l=>h.value=l),type:"textarea",label:"Descripcion",hint:"Descripcion del anuncio","lazy-rules":"",rules:[l=>l&&l.length>0||"Escribe algo"]},null,8,["modelValue","rules"]),k($e,{filled:"","bottom-slots":"",modelValue:m.value,"onUpdate:modelValue":o[4]||(o[4]=l=>m.value=l),label:"Imagen/es",counter:"",multiple:"",accept:".jpg, image/*","lazy-rules":"",rules:[l=>l&&l.length>0||"Tiene que tener una img minimo"]},{prepend:R(()=>[k(A,{name:"cloud_upload",onClick:o[2]||(o[2]=O(()=>{},["stop","prevent"]))})]),append:R(()=>[k(A,{name:"close",onClick:o[3]||(o[3]=O(l=>m.value.length=0,["stop","prevent"])),class:"cursor-pointer"})]),hint:R(()=>[Ke]),_:1},8,["modelValue","rules"]),Fe("div",null,[k(T,{label:"Submit",type:"submit",color:"primary"}),k(T,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1}))}});export{Ge as default};
